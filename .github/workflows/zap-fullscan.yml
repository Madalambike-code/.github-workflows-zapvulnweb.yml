name: ZAP Full Scan with Authentication

on:
  workflow_dispatch:

jobs:
  zap_scan:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: ZAP Full Scan
      uses: zaproxy/action-full-scan@v0.10.0
      with:
        target: "http://testphp.vulnweb.com"

        # Fix artifact issues
        artifact_name: "zap-report"
        allow_issue_writing: false
        issue_title: ""

        # Authentication configuration
        cmd_options: >
          -z "
          -config scripts.scripts.enable=true
          -config scripts.autoRun.enable=true
          -config authentication.loginUrl=http://testphp.vulnweb.com/userinfo.php
          -config authentication.loginScript=/github/workspace/zap-scripts/login.js
          -config authentication.username=test
          -config authentication.password=test
          "
